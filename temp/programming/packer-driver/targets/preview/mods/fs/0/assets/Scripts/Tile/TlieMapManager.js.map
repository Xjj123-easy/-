{"version":3,"sources":["file:///E:/cocosproject/Dome/cocos-start-demo/assets/Scripts/Tile/TlieMapManager.ts"],"names":["_decorator","Component","DataManager","ResourcesManager","creatUINode","RandomNumer","TlieManager","ccclass","TlieMapManager","init","mapInfo","Instance","SpriteFrames","loaddir","tileInfo","i","length","column","j","item","src","type","node","number","imgSrc","spriteFrame","find","v","name","tileManager","addComponent","setParent"],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAASA,MAAAA,U,OAAAA,U;AAAYC,MAAAA,S,OAAAA,S;;AAEdC,MAAAA,W;;AACAC,MAAAA,gB;;AACEC,MAAAA,W,iBAAAA,W;AAAaC,MAAAA,W,iBAAAA,W;;AACbC,MAAAA,W,iBAAAA,W;;;;;;;OACH;AAAEC,QAAAA;AAAF,O,GAAcP,U;AAEpB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;gCAGaQ,c,WADZD,OAAO,CAAC,gBAAD,C,gBAAR,MACaC,cADb,SACoCP,SADpC,CAC8C;AACtCQ,QAAAA,IAAI,GAAG;AAAA;;AAAA;AACX,gBAAM;AAAEC,cAAAA;AAAF,gBAAc;AAAA;AAAA,4CAAYC,QAAhC;AAEA,gBAAMC,YAAY,SAAS;AAAA;AAAA,sDAAiBD,QAAjB,CAA0BE,OAA1B,CAAkC,oBAAlC,CAA3B,CAHW,CAIX;AAEA;;AACA;AAAA;AAAA,4CAAYF,QAAZ,CAAqBG,QAArB,GAAgC,EAAhC;;AACA,iBAAK,IAAIC,CAAC,GAAG,CAAb,EAAgBA,CAAC,GAAGL,OAAO,CAACM,MAA5B,EAAoCD,CAAC,EAArC,EAAyC;AACvC,kBAAME,MAAM,GAAGP,OAAO,CAACK,CAAD,CAAtB;AACA;AAAA;AAAA,8CAAYJ,QAAZ,CAAqBG,QAArB,CAA8BC,CAA9B,IAAmC,EAAnC;;AAFuC,yCAG9BG,CAH8B;AAIrC,oBAAMC,IAAI,GAAGF,MAAM,CAACC,CAAD,CAAnB;;AACA,oBAAIC,IAAI,CAACC,GAAL,KAAa,IAAb,IAAqBD,IAAI,CAACE,IAAL,KAAc,IAAvC,EAA6C;AAC3C;AACD;;AACD,oBAAMC,IAAI,GAAG;AAAA;AAAA,iDAAb,CARqC,CAUrC;;AACA,oBAAIC,MAAM,GAAGJ,IAAI,CAACC,GAAlB;;AACA,oBAAI,CAACG,MAAM,KAAK,CAAX,IAAgBA,MAAM,KAAK,CAA3B,IAAgCA,MAAM,KAAK,CAA5C,KAAkDR,CAAC,GAAG,CAAJ,KAAU,CAA5D,IAAiEG,CAAC,GAAG,CAAJ,KAAU,CAA/E,EAAkF;AAChFK,kBAAAA,MAAM,IAAI;AAAA;AAAA,kDAAY,CAAZ,EAAe,CAAf,CAAV;AACD;;AACD,oBAAMC,MAAM,cAAYD,MAAZ,MAAZ;AAEA,oBAAME,WAAW,GAAGb,YAAY,CAACc,IAAb,CAAkBC,CAAC,IAAIA,CAAC,CAACC,IAAF,KAAWJ,MAAlC,KAA6CZ,YAAY,CAAC,CAAD,CAA7E;AAEA,oBAAMiB,WAAW,GAAGP,IAAI,CAACQ,YAAL;AAAA;AAAA,+CAApB;AAEA,oBAAMT,IAAI,GAAGF,IAAI,CAACE,IAAlB;AAEAQ,gBAAAA,WAAW,CAACpB,IAAZ,CAAiBY,IAAjB,EAAuBI,WAAvB,EAAoCV,CAApC,EAAuCG,CAAvC;AAEA;AAAA;AAAA,gDAAYP,QAAZ,CAAqBG,QAArB,CAA8BC,CAA9B,EAAiCG,CAAjC,IAAsCW,WAAtC;AAEAP,gBAAAA,IAAI,CAACS,SAAL,CAAe,KAAI,CAACT,IAApB;AA3BqC;;AAGvC,mBAAK,IAAIJ,CAAC,GAAG,CAAb,EAAgBA,CAAC,GAAGD,MAAM,CAACD,MAA3B,EAAmCE,CAAC,EAApC,EAAwC;AAAA,iCAA/BA,CAA+B;;AAAA,yCAGpC;AAsBH;AACF;AArCU;AAsCZ;;AAvC2C,O","sourcesContent":["import { _decorator, Component } from 'cc'\n\nimport DataManager from '../RunTime/DataManager'\nimport ResourcesManager from '../RunTime/ResourcesManager'\nimport { creatUINode, RandomNumer } from '../Utiils'\nimport { TlieManager } from './TileManager'\nconst { ccclass } = _decorator\n\n/**\n * Predefined variables\n * Name = BattleManager\n * DateTime = Fri May 19 2023 14:21:20 GMT+0800 (中国标准时间)\n * Author = 杰哥真好\n * FileBasename = BattleManager.ts\n * FileBasenameNoExtension = BattleManager\n * URL = db://assets/Scripts/Scene/BattleManager.ts\n * ManualUrl = https://docs.cocos.com/creator/3.4/manual/zh/\n *\n */\n\n@ccclass('TlieMapManager')\nexport class TlieMapManager extends Component {\n  async init() {\n    const { mapInfo } = DataManager.Instance\n\n    const SpriteFrames = await ResourcesManager.Instance.loaddir('texture/tile/tile/')\n    //   console.log(SpriteFrames);\n\n    //遍历瓦片数组\n    DataManager.Instance.tileInfo = []\n    for (let i = 0; i < mapInfo.length; i++) {\n      const column = mapInfo[i]\n      DataManager.Instance.tileInfo[i] = []\n      for (let j = 0; j < column.length; j++) {\n        const item = column[j]\n        if (item.src === null || item.type === null) {\n          continue\n        }\n        const node = creatUINode()\n\n        //随机瓦片\n        let number = item.src\n        if ((number === 1 || number === 5 || number === 9) && i % 2 === 0 && j % 2 === 0) {\n          number += RandomNumer(0, 4)\n        }\n        const imgSrc = `tile (${number})`\n\n        const spriteFrame = SpriteFrames.find(v => v.name === imgSrc) || SpriteFrames[0]\n\n        const tileManager = node.addComponent(TlieManager)\n\n        const type = item.type\n\n        tileManager.init(type, spriteFrame, i, j)\n\n        DataManager.Instance.tileInfo[i][j] = tileManager\n\n        node.setParent(this.node)\n      }\n    }\n  }\n}\n"]}