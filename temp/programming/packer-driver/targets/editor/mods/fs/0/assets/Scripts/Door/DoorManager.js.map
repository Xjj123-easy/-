{"version":3,"sources":["file:///E:/cocosproject/Dome/cocos-start-demo/assets/Scripts/Door/DoorManager.ts"],"names":["_decorator","EVENTMANAGER","ENTINY_STATE_ENUM","EnityManger","DataManager","EventManager","DoorSubMachine","ccclass","property","DoorManager","init","param","fsm","addComponent","state","Instance","on","DOOR_OPEN","onOpen","onDestroy","off","update","enemes","every","enemy","DEATH"],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AACEA,MAAAA,U,OAAAA,U;;AAWAC,MAAAA,Y,iBAAAA,Y;AAGAC,MAAAA,iB,iBAAAA,iB;;AAKOC,MAAAA,W,iBAAAA,W;;AACFC,MAAAA,W;;AACAC,MAAAA,Y;;AACEC,MAAAA,c,iBAAAA,c;;;;;;;OAEH;AAAEC,QAAAA,OAAF;AAAWC,QAAAA;AAAX,O,GAAwBR,U;;6BAEjBS,W,WADZF,OAAO,CAAC,aAAD,C,gBAAR,MACaE,WADb;AAAA;AAAA,sCAC6C;AACjC,cAAJC,IAAI,CAACC,KAAD,EAAiB;AACzB,eAAKC,GAAL,GAAW,KAAKC,YAAL;AAAA;AAAA,+CAAX;AAEA,gBAAM,KAAKD,GAAL,CAASF,IAAT,EAAN;AAEA,gBAAMA,IAAN,CAAWC,KAAX;AACA,eAAKG,KAAL,GAAaH,KAAK,CAACG,KAAnB;AACA;AAAA;AAAA,4CAAaC,QAAb,CAAsBC,EAAtB,CAAyB;AAAA;AAAA,4CAAaC,SAAtC,EAAiD,KAAKC,MAAtD,EAA8D,IAA9D;AACD;;AAEDC,QAAAA,SAAS,GAAG;AACV;AAAA;AAAA,4CAAaJ,QAAb,CAAsBK,GAAtB,CAA0B;AAAA;AAAA,4CAAaH,SAAvC,EAAkD,KAAKC,MAAvD;AACD;;AACDG,QAAAA,MAAM,GAAG;AACP,gBAAMA,MAAN;AACD;AACD;AACF;AACA;AACA;AACA;AACA;;;AACEH,QAAAA,MAAM,GAAG;AACP,cAAI,CAAC;AAAA;AAAA,0CAAYH,QAAZ,CAAqBO,MAA1B,EAAkC;;AAClC,cACE;AAAA;AAAA,0CAAYP,QAAZ,CAAqBO,MAArB,CAA4BC,KAA5B,CAAmCC,KAAD,IAAwBA,KAAK,CAACV,KAAN,KAAgB,OAA1E,KACA,KAAKA,KAAL,KAAe;AAAA;AAAA,sDAAkBW,KAFnC,EAGE;AACA;AACA,iBAAKX,KAAL,GAAa;AAAA;AAAA,wDAAkBW,KAA/B;AACD;AACF;;AAhC0C,O","sourcesContent":["import {\n  _decorator,\n  Component,\n  Sprite,\n  UITransform,\n  animation,\n  AnimationClip,\n  SpriteFrame,\n  AnimationComponent,\n} from 'cc'\nimport {\n  CONTROLLER_ENMU,\n  EVENTMANAGER,\n  PARAMS_NAME_ENUM,\n  DRIECTION_ENUM,\n  ENTINY_STATE_ENUM,\n  DIRECTION_ORDER_ENUM,\n  ENTITY_TYPE_ENUM,\n} from '../../Enums'\nimport { IEntity } from '../../Level'\nimport { EnityManger } from '../Base/EnityManger'\nimport DataManager from '../RunTime/DataManager'\nimport EventManager from '../RunTime/EventManager'\nimport { DoorSubMachine } from './DoorSubMachine'\n\nconst { ccclass, property } = _decorator\n@ccclass('DoorManager')\nexport class DoorManager extends EnityManger {\n  async init(param: IEntity) {\n    this.fsm = this.addComponent(DoorSubMachine)\n\n    await this.fsm.init()\n\n    super.init(param)\n    this.state = param.state\n    EventManager.Instance.on(EVENTMANAGER.DOOR_OPEN, this.onOpen, this)\n  }\n\n  onDestroy() {\n    EventManager.Instance.off(EVENTMANAGER.DOOR_OPEN, this.onOpen)\n  }\n  update() {\n    super.update()\n  }\n  /**\n   * isInit 判断初始化\n   * changeDirection 改变敌人放向\n   * 通过对比敌人坐标跟player坐标在哪个象限\n   * dix diy 表示偏远量 靠近x轴 还是靠近y轴\n   */\n  onOpen() {\n    if (!DataManager.Instance.enemes) return\n    if (\n      DataManager.Instance.enemes.every((enemy: EnityManger) => enemy.state === 'DEATH') &&\n      this.state !== ENTINY_STATE_ENUM.DEATH\n    ) {\n      //\n      this.state = ENTINY_STATE_ENUM.DEATH\n    }\n  }\n}\n"]}